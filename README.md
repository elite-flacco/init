# TripWise - AI-Powered Travel Planning App

A Next.js + TypeScript full-stack travel planning application that helps users discover destinations and plan their trips through an interactive wizard interface with AI-powered recommendations.

## Features

- **Traveler Type Selection**: Choose from different travel personalities (Explorer, Type A, Overthinker, Chill)
- **AI-Powered Destination Discovery**: Get personalized destination recommendations based on your preferences
- **Progressive Trip Planning**: Interactive multi-step questionnaire with smooth scrolling and in-place editing
- **AI Trip Planning**: Comprehensive travel itineraries generated by AI with streaming support
- **User Account System**: Optional user accounts for enhanced experience
  - **Plan Management**: Save, organize, and manage your travel plans
  - **Destination Bookmarking**: Save interesting destinations with personal notes
  - **Inline Editing**: Edit plan names, add tags, mark favorites, and manage collections
  - **Authentication**: Secure signup/login with password reset functionality
- **Plan Sharing**: Share your travel plans with others via unique URLs
- **PDF & KML Export**: Export your plans as PDF documents or KML files for Google Maps
- **Enhanced User Experience**: Glassmorphism UI effects, scroll-based editing, animated transitions, and intuitive form progression
- **Modern Visual Design**: Neumorphic and glassmorphic card styles with subtle hover animations
- **Responsive Design**: Mobile-first approach with Tailwind CSS styling

## Architecture

This is a **Next.js 15 full-stack application** using the App Router:

- **Frontend**: React 19 + TypeScript with Next.js App Router
- **Backend**: Next.js API routes for AI services, plan sharing, and user management
- **Database**: Supabase PostgreSQL with Row Level Security (RLS)
- **Authentication**: Supabase Auth with JWT tokens
- **AI Integration**: OpenAI and Anthropic API support with streaming capabilities
- **Testing**: Vitest with React Testing Library
- **Styling**: Tailwind CSS with custom animations

## Getting Started

### Prerequisites

- Node.js (version 18 or higher)
- npm or yarn package manager

### Installation

1. Clone the repository
2. Install dependencies:
   ```bash
   npm install
   ```

### Development Commands

- **Start development server**: `npm run dev`
- **Build for production**: `npm run build`
- **Start production server**: `npm start`
- **Lint code**: `npm run lint`
- **Preview production build**: `npm run preview`

## Project Structure

```
app/                                 # Next.js App Router
├── api/                            # Backend API routes
│   ├── ai/                         # AI service endpoints
│   │   ├── config.ts
│   │   ├── destinations/route.ts   # Destination recommendation API
│   │   ├── trip-planning/         # Trip planning APIs
│   │   │   ├── route.ts           # Legacy endpoint
│   │   │   ├── chunked/route.ts   # Parallel processing
│   │   │   ├── stream/route.ts    # Real-time streaming
│   │   │   └── manifest/route.ts  # Quick plan overview
│   │   ├── test/route.ts          # AI service testing
│   │   └── images/destination/    # Dynamic image service
│   ├── shared-plans/              # Plan sharing API
│   │   ├── [id]/route.ts          # Get shared plan
│   │   └── route.ts               # Create shared plan
│   └── user/                      # User account APIs
│       ├── plans/                 # User plan management
│       │   ├── [id]/route.ts      # Individual plan operations
│       │   ├── list/route.ts      # List user plans
│       │   └── route.ts           # Create/read plans
│       └── destinations/          # User destination management
│           ├── [id]/route.ts      # Individual destination operations
│           └── route.ts           # Create/read destinations
├── share/[id]/                    # Shared plan viewing pages
│   └── page.tsx
├── reset-password/                # Password reset page
│   └── page.tsx
├── layout.tsx                     # Root layout
└── page.tsx                       # Main application page

src/                               # Shared frontend code
├── components/                    # React components
│   ├── ui/                       # Reusable UI components
│   │   ├── BaseLoading.tsx
│   │   ├── Card.tsx
│   │   ├── CategoryGroup.tsx
│   │   ├── ConfirmDialog.tsx
│   │   ├── DestinationLoading.tsx
│   │   ├── FeedbackButton.tsx
│   │   ├── Icon3D.tsx
│   │   ├── ItemCard.tsx
│   │   ├── ItemGrid.tsx
│   │   ├── KMLExportLoading.tsx
│   │   ├── RestaurantItem.tsx
│   │   ├── SectionHeader.tsx
│   │   ├── TravelPlanLoading.tsx
│   │   └── TravelPlanSection.tsx
│   ├── auth/                     # Authentication components
│   │   ├── AuthModal.tsx
│   │   ├── AuthModalManager.tsx
│   │   ├── LoginModal.tsx
│   │   ├── SignupModal.tsx
│   │   └── index.ts
│   ├── AIDestinationRecommendationResults.tsx
│   ├── AITravelPlan.tsx
│   ├── AITripPlanningPrompts.tsx
│   ├── DestinationCard.tsx
│   ├── DestinationDetailsModal.tsx
│   ├── DestinationInputComponent.tsx
│   ├── DestinationKnowledgeSelection.tsx
│   ├── ErrorBoundary.tsx
│   ├── GoogleAnalytics.tsx
│   ├── PickMyDestinationFlow.tsx
│   ├── PlaceholderMessage.tsx
│   ├── ProgressiveForm.tsx        # Progressive multi-step form
│   ├── QuestionStep.tsx           # Individual question component
│   ├── TravelProgressIndicator.tsx
│   ├── TravelerTypeSelection.tsx
│   └── UserSidebar.tsx           # User account sidebar
├── data/                          # Static data and mocks
│   ├── mock/
│   │   ├── destinations.ts
│   │   ├── travelData.ts
│   │   └── travelerTypes.ts
│   ├── travelQuestions.ts
│   └── travelerTypes.ts
├── services/                      # Business logic services
│   ├── aiDestinationService.ts    # AI destination recommendations
│   ├── aiTripPlanningService.ts   # AI trip planning
│   ├── geocodingService.ts        # Location services
│   ├── kmlExportService.ts        # KML export functionality
│   ├── pdfExportService.ts        # PDF export functionality
│   ├── pixabayService.ts          # Dynamic image service
│   └── unsplashService.ts         # Image fallback service
├── contexts/                      # React contexts
│   └── AuthContext.tsx           # Authentication context
├── hooks/                         # Custom React hooks
│   ├── useAuth.ts                # Authentication hook
│   ├── useDestinationImage.ts    # Image fetching hook
│   ├── useParallelTripPlanning.ts # Parallel processing hook
│   ├── useStreamingTripPlanning.ts # Streaming hook
│   └── useTypingEffect.ts        # Typing animation hook
├── types/
│   └── travel.ts                  # TypeScript interfaces
├── lib/
│   ├── analytics.ts               # Analytics utilities
│   ├── auth.ts                    # Authentication utilities
│   ├── security.ts                # Security middleware
│   ├── tokenUtils.ts              # Token validation utilities
│   └── utils.ts                   # General utility functions
├── utils/                         # UI utilities
│   ├── iconMapping.tsx            # Icon mapping for destinations
│   └── iconMappingUtils.tsx       # Icon utility functions
└── test/                          # Test configuration
    ├── mocks.ts
    └── setup.ts
```

## Technology Stack

- **Next.js 15** - Full-stack React framework with App Router
- **React 19** - UI framework
- **TypeScript** - Type safety
- **Supabase** - Database and authentication
- **Tailwind CSS** - Styling framework
- **Framer Motion** - Animations
- **Vitest** - Testing framework
- **OpenAI/Anthropic APIs** - AI services with streaming support
- **Lucide React** - Icons
- **jsPDF & html2canvas** - PDF export
- **Pixabay/Unsplash APIs** - Dynamic destination images
- **ESLint** - Code linting

## App Flow

The app follows a multi-step wizard pattern:

1. **Traveler Type Selection** (`/`) - User selects travel personality
2. **Destination Knowledge** - User indicates if they know where to go
3. **Pick Destination Flow** - AI-powered destination questionnaire (if needed)
4. **Destination Recommendations** - AI shows personalized destination options
5. **Trip Planning** - User answers trip planning questions
6. **Final Plan** - AI generates comprehensive travel itinerary
7. **Plan Sharing** - Users can share plans via `/share/[id]` URLs

## Configuration

### Environment Variables

```bash
# Database & Authentication (Required for user accounts)
NEXT_PUBLIC_SUPABASE_URL=https://your-project-id.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key

# AI Provider Configuration
AI_PROVIDER=mock                    # openai, anthropic, or mock
OPENAI_API_KEY=your_openai_key     # For OpenAI services
ANTHROPIC_API_KEY=your_anthropic_key # For Anthropic services

# AI Settings
AI_MODEL=gpt-4
AI_MAX_TOKENS=8000
AI_TEMPERATURE=0.7
AI_BASE_URL=                       # Optional: Custom OpenAI-compatible endpoint
AI_ENABLE_CHUNKING=true           # Enable request chunking
AI_CHUNK_TOKEN_LIMIT=4000         # Max tokens per chunk
AI_MAX_CHUNKS=4                   # Maximum number of chunks

# Image Services (Optional)
PIXABAY_API_KEY=your_pixabay_key  # For dynamic destination images

# Analytics (Optional)
NEXT_PUBLIC_GA_MEASUREMENT_ID=your_ga_id # Google Analytics
```

## Testing

```bash
# Run tests
npm test

# Run tests with UI
npm run test:ui

# Run tests once
npm run test:run

# Run tests with coverage
npm run test:coverage
```

## Development Setup

This project includes Claude Code integration for enhanced development workflow:

- **Type checking**: Automatic TypeScript compilation checks
- **Code formatting**: ESLint integration
- **Testing**: Comprehensive test suite with Vitest

### Configuration Files

- `next.config.js` - Next.js configuration
- `tailwind.config.js` - Tailwind CSS configuration
- `postcss.config.js` - PostCSS configuration
- `tsconfig.json` - TypeScript configuration
- `vitest.config.ts` - Testing configuration
- `CLAUDE.md` - Project documentation for Claude Code

## API Routes

### AI Services

- **POST /api/ai/destinations** - Get destination recommendations
- **POST /api/ai/trip-planning/manifest** - Generate quick travel plan overview
- **POST /api/ai/trip-planning/stream** - Real-time streaming trip planning (OpenAI)
- **POST /api/ai/trip-planning/chunked** - Parallel chunk processing (fallback)
- **GET /api/ai/test** - Test AI service connectivity
- **GET /api/images/destination** - Fetch dynamic destination images

### Plan Management

- **POST /api/shared-plans** - Create shareable plan
- **GET /api/shared-plans/[id]** - Retrieve shared plan

### User Account Management (Authentication Required)

- **GET /api/user/plans** - Get user's saved travel plans
- **POST /api/user/plans** - Save a new travel plan
- **GET /api/user/plans/[id]** - Get specific plan details
- **PUT /api/user/plans/[id]** - Update plan (name, tags, favorite status)
- **DELETE /api/user/plans/[id]** - Delete a saved plan
- **GET /api/user/destinations** - Get user's saved destinations
- **POST /api/user/destinations** - Save a new destination
- **GET /api/user/destinations/[id]** - Get specific destination details
- **PUT /api/user/destinations/[id]** - Update destination notes
- **DELETE /api/user/destinations/[id]** - Remove saved destination
