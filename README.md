# âœˆï¸ TripWise - AI-Powered Travel Planning App

A Next.js + TypeScript full-stack travel planning application that helps users discover destinations and plan their trips through an interactive wizard interface with AI-powered recommendations.

## âœ¨ Features

- ğŸ§³ **Traveler Type Selection**: Choose from different travel personalities (Explorer, Type A, Overthinker, Chill)
- ğŸ¤– **AI-Powered Destination Discovery**: Get personalized destination recommendations based on your preferences
- ğŸ“ **Progressive Trip Planning**: Interactive multi-step questionnaire with smooth scrolling and in-place editing
- âœ¨ **AI Trip Planning**: Comprehensive travel itineraries generated by AI with streaming support
- ğŸ‘¤ **User Account System**: Optional user accounts for enhanced experience
  - Save, organize, and manage your travel plans
  - Bookmark destinations with personal notes
  - Edit plan names, add tags, mark favorites, and manage collections
  - Secure signup/login with password reset functionality
- ğŸ”— **Plan Sharing**: Share your travel plans with others via unique URLs
- ğŸ“„ **PDF & KML Export**: Export your plans as PDF documents or KML files for Google Maps
- ğŸ¨ **Enhanced User Experience**: Glassmorphism UI effects, scroll-based editing, animated transitions, and intuitive form progression
- ğŸ“± **Responsive Design**: Mobile-first approach with Tailwind CSS styling

## ğŸ—ï¸ Architecture

This is a **Next.js 15 full-stack application** using the App Router:

- **Frontend**: React 19 + TypeScript with Next.js App Router
- **Backend**: Next.js API routes for AI services, plan sharing, and user management
- **Database**: Supabase PostgreSQL with Row Level Security (RLS)
- **Authentication**: Supabase Auth with JWT tokens
- **AI Integration**: OpenAI and Anthropic API support with streaming capabilities
- **Testing**: Vitest with React Testing Library
- **Styling**: Tailwind CSS with custom animations

## ğŸš€ Getting Started

### Prerequisites

- Node.js (version 18 or higher)
- npm or yarn package manager

### Installation

1. Clone the repository
2. Install dependencies:
   ```bash
   npm install
   ```

### Development Commands

- ğŸ”¨ **Start development server**: `npm run dev`
- ğŸ“¦ **Build for production**: `npm run build`
- â–¶ï¸ **Start production server**: `npm start`
- ğŸ” **Lint code**: `npm run lint`
- ğŸ‘€ **Preview production build**: `npm run preview`

## ğŸ“ Project Structure

```
app/                                 # Next.js App Router
â”œâ”€â”€ api/                            # Backend API routes
â”‚   â”œâ”€â”€ ai/                         # AI service endpoints
â”‚   â”‚   â”œâ”€â”€ config.ts
â”‚   â”‚   â”œâ”€â”€ destinations/route.ts   # Destination recommendation API
â”‚   â”‚   â”œâ”€â”€ trip-planning/         # Trip planning APIs
â”‚   â”‚   â”‚   â”œâ”€â”€ route.ts           # Legacy endpoint
â”‚   â”‚   â”‚   â”œâ”€â”€ chunked/route.ts   # Parallel processing
â”‚   â”‚   â”‚   â”œâ”€â”€ stream/route.ts    # Real-time streaming
â”‚   â”‚   â”‚   â””â”€â”€ manifest/route.ts  # Quick plan overview
â”‚   â”‚   â”œâ”€â”€ test/route.ts          # AI service testing
â”‚   â”‚   â””â”€â”€ images/destination/    # Dynamic image service
â”‚   â”œâ”€â”€ shared-plans/              # Plan sharing API
â”‚   â”‚   â”œâ”€â”€ [id]/route.ts          # Get shared plan
â”‚   â”‚   â””â”€â”€ route.ts               # Create shared plan
â”‚   â””â”€â”€ user/                      # User account APIs
â”‚       â”œâ”€â”€ plans/                 # User plan management
â”‚       â”‚   â”œâ”€â”€ [id]/route.ts      # Individual plan operations
â”‚       â”‚   â”œâ”€â”€ list/route.ts      # List user plans
â”‚       â”‚   â””â”€â”€ route.ts           # Create/read plans
â”‚       â””â”€â”€ destinations/          # User destination management
â”‚           â”œâ”€â”€ [id]/route.ts      # Individual destination operations
â”‚           â””â”€â”€ route.ts           # Create/read destinations
â”œâ”€â”€ share/[id]/                    # Shared plan viewing pages
â”‚   â””â”€â”€ page.tsx
â”œâ”€â”€ reset-password/                # Password reset page
â”‚   â””â”€â”€ page.tsx
â”œâ”€â”€ layout.tsx                     # Root layout
â””â”€â”€ page.tsx                       # Main application page

src/                               # Shared frontend code
â”œâ”€â”€ components/                    # React components
â”‚   â”œâ”€â”€ ui/                       # Reusable UI components
â”‚   â”‚   â”œâ”€â”€ BaseLoading.tsx
â”‚   â”‚   â”œâ”€â”€ Card.tsx
â”‚   â”‚   â”œâ”€â”€ CategoryGroup.tsx
â”‚   â”‚   â”œâ”€â”€ ConfirmDialog.tsx
â”‚   â”‚   â”œâ”€â”€ DestinationLoading.tsx
â”‚   â”‚   â”œâ”€â”€ FeedbackButton.tsx
â”‚   â”‚   â”œâ”€â”€ Icon3D.tsx
â”‚   â”‚   â”œâ”€â”€ ItemCard.tsx
â”‚   â”‚   â”œâ”€â”€ ItemGrid.tsx
â”‚   â”‚   â”œâ”€â”€ KMLExportLoading.tsx
â”‚   â”‚   â”œâ”€â”€ RestaurantItem.tsx
â”‚   â”‚   â”œâ”€â”€ SectionHeader.tsx
â”‚   â”‚   â”œâ”€â”€ TravelPlanLoading.tsx
â”‚   â”‚   â””â”€â”€ TravelPlanSection.tsx
â”‚   â”œâ”€â”€ auth/                     # Authentication components
â”‚   â”‚   â”œâ”€â”€ AuthModal.tsx
â”‚   â”‚   â”œâ”€â”€ AuthModalManager.tsx
â”‚   â”‚   â”œâ”€â”€ LoginModal.tsx
â”‚   â”‚   â”œâ”€â”€ SignupModal.tsx
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ AIDestinationRecommendationResults.tsx
â”‚   â”œâ”€â”€ AITravelPlan.tsx
â”‚   â”œâ”€â”€ AITripPlanningPrompts.tsx
â”‚   â”œâ”€â”€ DestinationCard.tsx
â”‚   â”œâ”€â”€ DestinationDetailsModal.tsx
â”‚   â”œâ”€â”€ DestinationInputComponent.tsx
â”‚   â”œâ”€â”€ DestinationKnowledgeSelection.tsx
â”‚   â”œâ”€â”€ ErrorBoundary.tsx
â”‚   â”œâ”€â”€ GoogleAnalytics.tsx
â”‚   â”œâ”€â”€ PickMyDestinationFlow.tsx
â”‚   â”œâ”€â”€ PlaceholderMessage.tsx
â”‚   â”œâ”€â”€ ProgressiveForm.tsx        # Progressive multi-step form
â”‚   â”œâ”€â”€ QuestionStep.tsx           # Individual question component
â”‚   â”œâ”€â”€ TravelProgressIndicator.tsx
â”‚   â”œâ”€â”€ TravelerTypeSelection.tsx
â”‚   â””â”€â”€ UserSidebar.tsx           # User account sidebar
â”œâ”€â”€ data/                          # Static data and mocks
â”‚   â”œâ”€â”€ mock/
â”‚   â”‚   â”œâ”€â”€ destinations.ts
â”‚   â”‚   â”œâ”€â”€ travelData.ts
â”‚   â”‚   â””â”€â”€ travelerTypes.ts
â”‚   â”œâ”€â”€ travelQuestions.ts
â”‚   â””â”€â”€ travelerTypes.ts
â”œâ”€â”€ services/                      # Business logic services
â”‚   â”œâ”€â”€ aiDestinationService.ts    # AI destination recommendations
â”‚   â”œâ”€â”€ aiTripPlanningService.ts   # AI trip planning
â”‚   â”œâ”€â”€ geocodingService.ts        # Location services
â”‚   â”œâ”€â”€ kmlExportService.ts        # KML export functionality
â”‚   â”œâ”€â”€ pdfExportService.ts        # PDF export functionality
â”‚   â”œâ”€â”€ pixabayService.ts          # Dynamic image service
â”‚   â””â”€â”€ unsplashService.ts         # Image fallback service
â”œâ”€â”€ contexts/                      # React contexts
â”‚   â””â”€â”€ AuthContext.tsx           # Authentication context
â”œâ”€â”€ hooks/                         # Custom React hooks
â”‚   â”œâ”€â”€ useAuth.ts                # Authentication hook
â”‚   â”œâ”€â”€ useDestinationImage.ts    # Image fetching hook
â”‚   â”œâ”€â”€ useParallelTripPlanning.ts # Parallel processing hook
â”‚   â”œâ”€â”€ useStreamingTripPlanning.ts # Streaming hook
â”‚   â””â”€â”€ useTypingEffect.ts        # Typing animation hook
â”œâ”€â”€ types/
â”‚   â””â”€â”€ travel.ts                  # TypeScript interfaces
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ analytics.ts               # Analytics utilities
â”‚   â”œâ”€â”€ auth.ts                    # Authentication utilities
â”‚   â”œâ”€â”€ security.ts                # Security middleware
â”‚   â”œâ”€â”€ tokenUtils.ts              # Token validation utilities
â”‚   â””â”€â”€ utils.ts                   # General utility functions
â”œâ”€â”€ utils/                         # UI utilities
â”‚   â”œâ”€â”€ iconMapping.tsx            # Icon mapping for destinations
â”‚   â””â”€â”€ iconMappingUtils.tsx       # Icon utility functions
â””â”€â”€ test/                          # Test configuration
    â”œâ”€â”€ mocks.ts
    â””â”€â”€ setup.ts
```

## ğŸ› ï¸ Technology Stack

- **Next.js 15** - Full-stack React framework with App Router
- **React 19** - UI framework
- **TypeScript** - Type safety
- **Supabase** - Database and authentication
- **Tailwind CSS** - Styling framework
- **Framer Motion** - Animations
- **Vitest** - Testing framework
- **OpenAI/Anthropic APIs** - AI services with streaming support
- **Lucide React** - Icons
- **jsPDF & html2canvas** - PDF export
- **Pixabay/Unsplash APIs** - Dynamic destination images
- **ESLint** - Code linting

## ğŸ—ºï¸ App Flow

The app follows a multi-step wizard pattern:

1. **Traveler Type Selection** (`/`) - User selects travel personality
2. **Destination Knowledge** - User indicates if they know where to go
3. **Pick Destination Flow** - AI-powered destination questionnaire (if needed)
4. **Destination Recommendations** - AI shows personalized destination options
5. **Trip Planning** - User answers trip planning questions
6. **Final Plan** - AI generates comprehensive travel itinerary
7. **Plan Sharing** - Users can share plans via `/share/[id]` URLs

## âš™ï¸ Configuration

### Environment Variables

```bash
# Database & Authentication (Required for user accounts)
NEXT_PUBLIC_SUPABASE_URL=https://your-project-id.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key
SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key

# AI Provider Configuration
AI_PROVIDER=mock                    # openai, anthropic, or mock
OPENAI_API_KEY=your_openai_key     # For OpenAI services
ANTHROPIC_API_KEY=your_anthropic_key # For Anthropic services

# AI Settings
AI_MODEL=gpt-4
AI_MAX_TOKENS=8000
AI_TEMPERATURE=0.7
AI_BASE_URL=                       # Optional: Custom OpenAI-compatible endpoint
AI_ENABLE_CHUNKING=true           # Enable request chunking
AI_CHUNK_TOKEN_LIMIT=4000         # Max tokens per chunk
AI_MAX_CHUNKS=4                   # Maximum number of chunks

# Image Services (Optional)
PIXABAY_API_KEY=your_pixabay_key  # For dynamic destination images

# Analytics (Optional)
NEXT_PUBLIC_GA_MEASUREMENT_ID=your_ga_id # Google Analytics
```

## ğŸ§ª Testing

```bash
# Run tests
npm test

# Run tests with UI
npm run test:ui

# Run tests once
npm run test:run

# Run tests with coverage
npm run test:coverage
```

## ğŸ’» Development Setup

This project includes Claude Code integration for enhanced development workflow:

- **Type checking**: Automatic TypeScript compilation checks
- **Code formatting**: ESLint integration
- **Testing**: Comprehensive test suite with Vitest

### Configuration Files

- `next.config.js` - Next.js configuration
- `tailwind.config.js` - Tailwind CSS configuration
- `postcss.config.js` - PostCSS configuration
- `tsconfig.json` - TypeScript configuration
- `vitest.config.ts` - Testing configuration
- `CLAUDE.md` - Project documentation for Claude Code

## ğŸ”Œ API Routes

### AI Services

- **POST /api/ai/destinations** - Get destination recommendations
- **POST /api/ai/trip-planning/manifest** - Generate quick travel plan overview
- **POST /api/ai/trip-planning/stream** - Real-time streaming trip planning (OpenAI)
- **POST /api/ai/trip-planning/chunked** - Parallel chunk processing (fallback)
- **GET /api/ai/test** - Test AI service connectivity
- **GET /api/images/destination** - Fetch dynamic destination images

### Plan Management

- **POST /api/shared-plans** - Create shareable plan
- **GET /api/shared-plans/[id]** - Retrieve shared plan

### User Account Management (Authentication Required)

- **GET /api/user/plans** - Get user's saved travel plans
- **POST /api/user/plans** - Save a new travel plan
- **GET /api/user/plans/[id]** - Get specific plan details
- **PUT /api/user/plans/[id]** - Update plan (name, tags, favorite status)
- **DELETE /api/user/plans/[id]** - Delete a saved plan
- **GET /api/user/destinations** - Get user's saved destinations
- **POST /api/user/destinations** - Save a new destination
- **GET /api/user/destinations/[id]** - Get specific destination details
- **PUT /api/user/destinations/[id]** - Update destination notes
- **DELETE /api/user/destinations/[id]** - Remove saved destination
